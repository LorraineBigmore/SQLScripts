--Collect memory information from SQL Server
print 'servername'
print '-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'
select @@SERVERNAME

print 'sys.databases'
print '-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'
select * from sys.databases

print 'dbcc memorystatus'
print '-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'
dbcc memorystatus

print 'dm_os_ring_buffers' -- RING_BUFFER_RESOURCE_MONITOR
print '-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'
select top 1 * from sys.dm_os_ring_buffers where ring_buffer_type = 'RING_BUFFER_RESOURCE_MONITOR' order by timestamp desc


print 'dm_os_ring_buffers' -- RING_BUFFER_MEMORY_BROKER
print '-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'
select * from sys.dm_os_ring_buffers where ring_buffer_type = 'RING_BUFFER_MEMORY_BROKER'


print 'dm_os_ring_buffers' -- RING_BUFFER_OOM
print '-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'
select * from sys.dm_os_ring_buffers where ring_buffer_type = 'RING_BUFFER_OOM' 


print 'dm_resource_governor_resource_pools'
print '-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'
select * from sys.dm_resource_governor_resource_pools


print 'dm_os_memory_brokers'
print '-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'
select * from sys.dm_os_memory_brokers


print 'dm_os_memory_clerks'
print '-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'
select * from sys.dm_os_memory_clerks


print 'dm_os_memory_objects'
print '-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'
select * from sys.dm_os_memory_objects


print 'dm_xtp_system_memory_consumers'
print '-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------'
select * from sys.dm_xtp_system_memory_consumers
